/**
 * 02. Task Queue (Macrotask Queue)
 *
 * í•™ìŠµ ëª©í‘œ:
 * - Task Queueê°€ ë¬´ì—‡ì¸ì§€ ì´í•´í•˜ê¸°
 * - setTimeout, setIntervalì˜ ë™ì‘ ì›ë¦¬ íŒŒì•…í•˜ê¸°
 * - Call Stackê³¼ Task Queueì˜ ê´€ê³„ ì´í•´í•˜ê¸°
 * - ì´ë²¤íŠ¸ ë£¨í”„ì˜ ê¸°ë³¸ ë™ì‘ ì´í•´í•˜ê¸°
 */

console.log("=== Task Queue ê¸°ë³¸ ê°œë… í•™ìŠµ ===\n");

/**
 * Task Queueë€?
 *
 * Task Queue (ë˜ëŠ” Macrotask Queue)ëŠ” ë¹„ë™ê¸° ì‘ì—…ë“¤ì´ ëŒ€ê¸°í•˜ëŠ” íì…ë‹ˆë‹¤.
 *
 * ì£¼ìš” Task Queue ì‘ì—…:
 * - setTimeout
 * - setInterval
 * - setImmediate (Node.js)
 * - I/O ì‘ì—…
 * - UI ë Œë”ë§
 *
 * ì´ë²¤íŠ¸ ë£¨í”„ì˜ ê¸°ë³¸ ë™ì‘:
 * 1. Call Stackì´ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸
 * 2. Call Stackì´ ë¹„ì–´ìˆìœ¼ë©´ Task Queueì—ì„œ ì‘ì—… í•˜ë‚˜ë¥¼ ê°€ì ¸ì˜´
 * 3. ê°€ì ¸ì˜¨ ì‘ì—…ì„ Call Stackì— ì¶”ê°€í•˜ì—¬ ì‹¤í–‰
 * 4. 1ë²ˆìœ¼ë¡œ ëŒì•„ê°€ì„œ ë°˜ë³µ
 */

console.log("--- ì˜ˆì œ 1: setTimeoutì˜ ê¸°ë³¸ ë™ì‘ ---\n");

console.log("1. ë™ê¸° ì½”ë“œ ì‹œì‘");

setTimeout(() => {
	console.log("3. setTimeout ì½œë°± ì‹¤í–‰ (1ì´ˆ í›„)");
}, 1000);

console.log("2. ë™ê¸° ì½”ë“œ ì¢…ë£Œ");

/**
 * ì‹¤í–‰ íë¦„:
 *
 * [ë™ê¸° ì½”ë“œ ì‹¤í–‰ ë‹¨ê³„]
 * 1. "1. ë™ê¸° ì½”ë“œ ì‹œì‘" ì¶œë ¥ (Call Stack)
 * 2. setTimeout í˜¸ì¶œ â†’ Web APIì— íƒ€ì´ë¨¸ ë“±ë¡
 * 3. "2. ë™ê¸° ì½”ë“œ ì¢…ë£Œ" ì¶œë ¥ (Call Stack)
 * 4. Call Stack ë¹„ì–´ìˆìŒ
 *
 * [íƒ€ì´ë¨¸ ì™„ë£Œ í›„]
 * 5. 1ì´ˆ ê²½ê³¼ â†’ ì½œë°±ì´ Task Queueì— ì¶”ê°€ë¨
 * 6. ì´ë²¤íŠ¸ ë£¨í”„ê°€ Task Queueì˜ ì½œë°±ì„ Call Stackìœ¼ë¡œ ì´ë™
 * 7. "3. setTimeout ì½œë°± ì‹¤í–‰" ì¶œë ¥
 */

setTimeout(() => {
	console.log("\n==================================================\n");
	console.log("--- ì˜ˆì œ 2: setTimeout(0)ì˜ ì˜ë¯¸ ---\n");

	console.log("1. ë™ê¸° ì½”ë“œ A");

	setTimeout(() => {
		console.log("4. setTimeout(0) ì½œë°±");
	}, 0);

	console.log("2. ë™ê¸° ì½”ë“œ B");
	console.log("3. ë™ê¸° ì½”ë“œ C");

	/**
	 * setTimeout(0)ì˜ ì˜ë¯¸:
	 *
	 * - 0ms í›„ì— ì‹¤í–‰ë˜ëŠ” ê²ƒì´ ì•„ë‹˜!
	 * - "Call Stackì´ ë¹„ì›Œì§„ í›„ ê°€ëŠ¥í•œ ë¹¨ë¦¬ ì‹¤í–‰"
	 * - ìµœì†Œ ì§€ì—° ì‹œê°„ì€ ì•½ 4ms (ë¸Œë¼ìš°ì € í™˜ê²½)
	 *
	 * ì‹¤í–‰ ìˆœì„œ:
	 * 1. ë™ê¸° ì½”ë“œ A â†’ Call Stack
	 * 2. setTimeout(0) â†’ Task Queueì— ë“±ë¡
	 * 3. ë™ê¸° ì½”ë“œ B â†’ Call Stack
	 * 4. ë™ê¸° ì½”ë“œ C â†’ Call Stack
	 * 5. Call Stack ë¹„ì–´ìˆìŒ
	 * 6. ì´ë²¤íŠ¸ ë£¨í”„ê°€ Task Queueì˜ ì½œë°±ì„ ì‹¤í–‰
	 * 7. setTimeout(0) ì½œë°± â†’ Call Stack
	 */
}, 2000);

setTimeout(() => {
	console.log("\n==================================================\n");
	console.log("--- ì˜ˆì œ 3: ì—¬ëŸ¬ setTimeoutì˜ ì‹¤í–‰ ìˆœì„œ ---\n");

	console.log("A");

	setTimeout(() => {
		console.log("D (1000ms)");
	}, 1000);

	setTimeout(() => {
		console.log("C (500ms)");
	}, 500);

	setTimeout(() => {
		console.log("B (0ms)");
	}, 0);

	console.log("E");

	/**
	 * ì‹¤í–‰ ìˆœì„œ: A â†’ E â†’ B (0ms) â†’ C (500ms) â†’ D (1000ms)
	 *
	 * ì´ìœ :
	 * 1. A, EëŠ” ë™ê¸° ì½”ë“œì´ë¯€ë¡œ ì¦‰ì‹œ ì‹¤í–‰
	 * 2. setTimeoutë“¤ì€ ê°ê°ì˜ ì§€ì—°ì‹œê°„ í›„ Task Queueì— ì¶”ê°€
	 * 3. 0ms â†’ 500ms â†’ 1000ms ìˆœì„œë¡œ Task Queueì— ë„ì°©
	 * 4. ì´ë²¤íŠ¸ ë£¨í”„ê°€ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰
	 */
}, 4000);

/**
 * TODO 1: ì‹¤í–‰ ìˆœì„œ ì˜ˆì¸¡í•˜ê¸°
 *
 * ìš”êµ¬ì‚¬í•­:
 * ì•„ë˜ ì½”ë“œì˜ ì¶œë ¥ ìˆœì„œë¥¼ ì˜ˆì¸¡í•˜ì„¸ìš”.
 */

setTimeout(() => {
	console.log("\n==================================================\n");
	console.log("--- TODO 1: ì‹¤í–‰ ìˆœì„œ ì˜ˆì¸¡ ---\n");

	// console.log("ì‹œì‘");
	//
	// setTimeout(() => {
	//   console.log("íƒ€ì´ë¨¸ 1");
	// }, 0);
	//
	// setTimeout(() => {
	//   console.log("íƒ€ì´ë¨¸ 2");
	// }, 0);
	//
	// console.log("ì¢…ë£Œ");

	// ì˜ˆìƒ ì¶œë ¥ ìˆœì„œ:
	// 1.
	// 2.
	// 3.
	// 4.

	// ì´ìœ :
	// (ì—¬ê¸°ì— ì„¤ëª…ì„ ì‘ì„±í•˜ì„¸ìš”)

	console.log("(TODO 1ì„ ì™„ì„±í•˜ì„¸ìš”)\n");
	console.log("==================================================\n");
}, 6000);

/**
 * TODO 2: ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸ ë§Œë“¤ê¸°
 *
 * ìš”êµ¬ì‚¬í•­:
 * - startCountdown(n) í•¨ìˆ˜ë¥¼ ë§Œë“œì„¸ìš”
 * - në¶€í„° 0ê¹Œì§€ 1ì´ˆ ê°„ê²©ìœ¼ë¡œ ì¹´ìš´íŠ¸ë‹¤ìš´
 * - 0ì— ë„ë‹¬í•˜ë©´ "ë°œì‚¬!" ì¶œë ¥
 * - setTimeoutì„ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„
 */

setTimeout(() => {
	console.log("--- TODO 2: ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸ ---\n");

	// function startCountdown(n) {
	//   // íŒíŠ¸: ì¬ê·€ì ìœ¼ë¡œ setTimeoutì„ í˜¸ì¶œí•˜ë©´ ë©ë‹ˆë‹¤
	//   console.log(n);
	//
	//   if (n === 0) {
	//     console.log("ë°œì‚¬! ğŸš€");
	//     return;
	//   }
	//
	//   // 1ì´ˆ í›„ì— startCountdown(n - 1) í˜¸ì¶œ
	//   // ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
	// }

	// í…ŒìŠ¤íŠ¸ ì½”ë“œ
	// console.log("ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘:");
	// startCountdown(3);

	console.log("(TODO 2ë¥¼ ì™„ì„±í•˜ì„¸ìš”)\n");
	console.log("==================================================\n");
}, 8000);

/**
 * TODO 3: ìˆœì°¨ì  ë©”ì‹œì§€ ì¶œë ¥ê¸°
 *
 * ìš”êµ¬ì‚¬í•­:
 * - printMessages(messages, delay) í•¨ìˆ˜ë¥¼ ë§Œë“œì„¸ìš”
 * - messages: ë¬¸ìì—´ ë°°ì—´
 * - delay: ê° ë©”ì‹œì§€ ì‚¬ì´ì˜ ì§€ì—° ì‹œê°„(ms)
 * - ë°°ì—´ì˜ ê° ë©”ì‹œì§€ë¥¼ ìˆœì„œëŒ€ë¡œ delayë§Œí¼ ê°„ê²©ì„ ë‘ê³  ì¶œë ¥
 */

setTimeout(() => {
	console.log("--- TODO 3: ìˆœì°¨ì  ë©”ì‹œì§€ ì¶œë ¥ê¸° ---\n");

	// function printMessages(messages, delay) {
	//   // íŒíŠ¸: messages.forEachì™€ setTimeoutì„ ì¡°í•©í•˜ë˜,
	//   // ê° ë©”ì‹œì§€ë§ˆë‹¤ ë‹¤ë¥¸ ì§€ì—° ì‹œê°„ì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤
	//
	//   // ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
	// }

	// í…ŒìŠ¤íŠ¸ ì½”ë“œ
	// const messages = ["ì²« ë²ˆì§¸", "ë‘ ë²ˆì§¸", "ì„¸ ë²ˆì§¸", "ë„¤ ë²ˆì§¸"];
	// console.log("ë©”ì‹œì§€ ì¶œë ¥ ì‹œì‘:");
	// printMessages(messages, 500);

	console.log("(TODO 3ì„ ì™„ì„±í•˜ì„¸ìš”)\n");
	console.log("==================================================\n");
}, 10000);

/**
 * TODO 4: setIntervalë¡œ ë°˜ë³µ ì‘ì—… ë§Œë“¤ê¸°
 *
 * ìš”êµ¬ì‚¬í•­:
 * - 0ë¶€í„° ì‹œì‘í•´ì„œ 1ì´ˆë§ˆë‹¤ ìˆ«ìë¥¼ 1ì”© ì¦ê°€ì‹œì¼œ ì¶œë ¥
 * - 5ì— ë„ë‹¬í•˜ë©´ ìë™ìœ¼ë¡œ ë©ˆì¶¤
 * - setIntervalê³¼ clearIntervalì„ ì‚¬ìš©
 */

setTimeout(() => {
	console.log("--- TODO 4: setInterval ë°˜ë³µ ì‘ì—… ---\n");

	// let count = 0;
	//
	// const intervalId = setInterval(() => {
	//   console.log(`ì¹´ìš´íŠ¸: ${count}`);
	//   count++;
	//
	//   // 5ì— ë„ë‹¬í•˜ë©´ interval ì¤‘ì§€
	//   if (count > 5) {
	//     // ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
	//     console.log("ì¹´ìš´íŠ¸ ì¢…ë£Œ");
	//   }
	// }, 1000);

	console.log("(TODO 4ë¥¼ ì™„ì„±í•˜ì„¸ìš”)\n");
	console.log("==================================================\n");
}, 12000);

/**
 * í•™ìŠµ ì •ë¦¬
 *
 * âœ… Task QueueëŠ” ë¹„ë™ê¸° ì‘ì—…(setTimeout, setInterval ë“±)ì´ ëŒ€ê¸°í•˜ëŠ” í
 * âœ… Call Stackì´ ë¹„ì–´ìˆì„ ë•Œë§Œ Task Queueì˜ ì‘ì—…ì´ ì‹¤í–‰ë¨
 * âœ… setTimeout(0)ì€ "ì¦‰ì‹œ ì‹¤í–‰"ì´ ì•„ë‹ˆë¼ "Call Stackì´ ë¹„ì›Œì§„ í›„ ì‹¤í–‰"
 * âœ… íƒ€ì´ë¨¸ ì§€ì—° ì‹œê°„ì€ "ìµœì†Œ ì§€ì—° ì‹œê°„"ì„ ì˜ë¯¸
 * âœ… ì´ë²¤íŠ¸ ë£¨í”„ê°€ Call Stackê³¼ Task Queueë¥¼ ì—°ê²°
 *
 * ë‹¤ìŒ í•™ìŠµ: 03-microtask-queue.js (Microtask Queueì™€ ìš°ì„ ìˆœìœ„)
 */

setTimeout(() => {
	console.log("\n=== 02. Task Queue í•™ìŠµ ì™„ë£Œ! ===");
	console.log("\nì •ë‹µ í™•ì¸: 02-task-queue-answer.js");
	console.log("ë‹¤ìŒ ë‹¨ê³„: node 03-microtask-queue.js\n");
}, 20000);
